!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("crypto-js"),require("@angular/common"),require("@angular/router"),require("@angular/common/http"),require("rxjs"),require("@angular/core")):"function"==typeof define&&define.amd?define("factor-utils",["exports","crypto-js","@angular/common","@angular/router","@angular/common/http","rxjs","@angular/core"],e):e(t["factor-utils"]={},t.CryptoJS,t.ng.common,t.ng.router,t.ng.common.http,t.rxjs,t.ng.core)}(this,function(t,e,a,n,i,r,o){"use strict";var c=(s.prototype["delete"]=function(t,e){if(a.isPlatformBrowser(this.platformId))if(e&&"string"!=typeof e)"object"==typeof e&&delete e[t];else switch(e){case"localStorage":delete localStorage[t];break;default:delete sessionStorage[t]}},s.prototype.get=function(t,e){var r;if(a.isPlatformBrowser(this.platformId))try{r=JSON.parse(this.getValue(t,e))}catch(n){r=this.getValue(t,e)}return r},s.prototype.getValue=function(t,e){var r;if(e&&"string"!=typeof e)"object"==typeof e&&(r=e[t]);else switch(e){case"localStorage":r=localStorage[t];break;default:r=sessionStorage[t]}return this.decrypt(r)},s.prototype.decrypt=function(t){return null!==t&&t!==undefined&&""!==t&&this.configuration&&this.configuration.storage&&this.configuration.storage.encryptionSecret&&(t=e.AES.decrypt(t,this.configuration.storage.encryptionSecret).toString(e.enc.Utf8)),t},s.prototype.encrypt=function(t){return null!==t&&t!==undefined&&""!==t&&this.configuration&&this.configuration.storage&&this.configuration.storage.encryptionSecret&&(t=e.AES.encrypt(t,this.configuration.storage.encryptionSecret)),t.toString()},s.prototype.set=function(t,e,r){if(a.isPlatformBrowser(this.platformId)){var n=this.encrypt(JSON.stringify(e));if(r&&"string"!=typeof r)r[t]=n;else switch(r){case"localStorage":localStorage[t]=n;break;default:sessionStorage[t]=n}}},s.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],s.ctorParameters=function(){return[{type:Object,decorators:[{type:o.Inject,args:[o.PLATFORM_ID]}]},{type:undefined,decorators:[{type:o.Inject,args:["FactorUtilsConfiguration"]}]}]},s.ngInjectableDef=o.defineInjectable({factory:function(){return new s(o.inject(o.PLATFORM_ID),o.inject("FactorUtilsConfiguration"))},token:s,providedIn:"root"}),s);function s(t,e){this.platformId=t,this.configuration=e}var l=(u.prototype.appendTrackingCode=function(t){try{if(t){this.trackingId=t;var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id="+t,document.head.appendChild(e);var r=document.createElement("script");r.innerHTML="\n         window.dataLayer = window.dataLayer || [];\n         function gtag(){dataLayer.push(arguments);}\n         gtag('js', new Date());\n         gtag('config', '"+t+"');\n       ",document.head.appendChild(r),this.initSubscribers()}}catch(n){console.error("Error appending google analytics"),console.error(n)}},u.prototype.initSubscribers=function(){var r=this;this.router.events.subscribe(function(t){try{"function"==typeof gtag&&t instanceof n.NavigationEnd&&r.trackingId&&setTimeout(function(){gtag("config",r.trackingId,{page_title:document.title,page_path:t.urlAfterRedirects})},100)}catch(e){console.error(e)}})},u.prototype.trackEvent=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),"function"==typeof gtag&&gtag("event",t,{event_category:e,event_label:r,value:n})},u.prototype.trackException=function(t,e){"function"==typeof gtag&&gtag("event","exception",{description:t,fatal:e})},u.prototype.setUserId=function(t){"function"==typeof gtag&&gtag("set",{user_id:t})},u.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],u.ctorParameters=function(){return[{type:n.Router}]},u.ngInjectableDef=o.defineInjectable({factory:function(){return new u(o.inject(n.Router))},token:u,providedIn:"root"}),u);function u(t){this.router=t}var g=(p.prototype.handleError=function(t){var e=this.injector.get(l);if(t instanceof i.HttpErrorResponse){if(navigator.onLine){var r=t.error?JSON.stringify(t.error):t.message;e.trackEvent(t.url,"Http Error",t.status+" - "+r)}}else{var n=this.injector.get(a.LocationStrategy),o=(r=t.message?t.message:t.toString(),t.stack?t.stack:t.toString());n instanceof a.PathLocationStrategy&&n.path(),e.trackEvent(r,"Javascript Error",o)}throw t},p.decorators=[{type:o.Injectable}],p.ctorParameters=function(){return[{type:o.Injector}]},p);function p(t){this.injector=t}var d=(f.prototype.handleError=function(t){if(t instanceof i.HttpErrorResponse&&navigator.onLine){var e=t.error?JSON.stringify(t.error):t.message;window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"http_error","gtm.errorMessage":e,"gtm.errorUrl":t.url,error_status:t.status})}throw t},f.decorators=[{type:o.Injectable}],f.ctorParameters=function(){return[{type:o.Injector}]},f);function f(t){this.injector=t}var y=(h.prototype.appendTrackingCode=function(t){try{if(t){this.trackingId=t;var e=document.createElement("script");e.innerHTML="\n          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n          })(window,document,'script','dataLayer','"+t+"');\n        ",document.head.appendChild(e);var r=document.createElement("noscript"),n=document.createElement("iframe");n.width="0",n.height="0",n.style.display="none",n.style.visibility="hidden",n.src="https://www.googletagmanager.com/ns.html?id="+t,r.appendChild(n),document.body.prepend(r)}}catch(o){console.error("Error appending google tag manager"),console.error(o)}},h.prototype.addVariable=function(t){window.dataLayer=window.dataLayer||[],window.dataLayer.push(t)},h.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],h.ctorParameters=function(){return[]},h.ngInjectableDef=o.defineInjectable({factory:function(){return new h},token:h,providedIn:"root"}),h);function h(){}var m=(v.prototype.loadValue=function(n){var o=this;if(n&&0<n.length)for(var a=[],t=function(t){var e=n.item(t),r=new FileReader;r.readAsDataURL(e),r.onload=function(){a.push({data:r.result,lastModifiedDate:e.lastModifiedDate,name:e.name,size:e.size}),a.length==n.length&&o.valueChangesSubject.next(0<a.length?a:null)}},e=0;e<n.length;e++)t(e)},v.prototype.open=function(){this.fileInput.click()},v);function v(t){var e=this;this.valueChangesSubject=new r.BehaviorSubject(null),this.valueChanges=this.valueChangesSubject.asObservable(),this.fileInput=document.createElement("input"),this.fileInput.style.display="none",this.fileInput.type="file",this.fileInput.accept=t&&t.accept?t.accept:"",this.fileInput.multiple=t&&t.multiple,this.fileInput.addEventListener("change",function(t){new FileReader;e.loadValue(t.target.files)}),document.body.appendChild(this.fileInput)}var w=(j.forRoot=function(t){return{ngModule:j,providers:[{provide:"FactorUtilsConfiguration",useValue:t}]}},j.decorators=[{type:o.NgModule,args:[{declarations:[],imports:[],exports:[]}]}],j);function j(){}t.StorageService=c,t.GoogleAnalyticsErrorHandler=g,t.GoogleAnalyticsService=l,t.GoogleTagManagerErrorHandler=d,t.GoogleTagManagerService=y,t.FilesList=m,t.UtilsModule=w,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=factor-utils.umd.min.js.map