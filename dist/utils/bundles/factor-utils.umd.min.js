!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http"),require("@angular/router"),require("crypto-js"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("factor-utils",["exports","@angular/core","@angular/common","@angular/common/http","@angular/router","crypto-js","rxjs","rxjs/operators"],e):e((t=t||self)["factor-utils"]={},t.ng.core,t.ng.common,t.ng.common.http,t.ng.router,t.cryptoJs,t.rxjs,t.rxjs.operators)}(this,(function(t,e,r,n,o,a,i,c){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function s(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function u(t,e){return function(r,n){e(r,n,t)}}var l=function(){function t(){var t={},e=[t.lightness,t.saturation].map((function(t){return t=t||[.35,.5,.65],Array.isArray(t)?t.concat():[t]}));this.L=e[0],this.S=e[1],"number"==typeof t.hue&&(t.hue={min:t.hue,max:t.hue}),"object"!=typeof t.hue||Array.isArray(t.hue)||(t.hue=[t.hue]),void 0===t.hue&&(t.hue=[]),this.hueRanges=t.hue.map((function(t){return{min:void 0===t.min?0:t.min,max:void 0===t.max?360:t.max}}))}return t.prototype.hash=function(t){var e=0;t+="x";for(var r=Math.round(65745979961613.07),n=0;n<t.length;n++)e>r&&(e=Math.round(e/137)),e=131*e+t.charCodeAt(n);return e},t.prototype.rgb2hex=function(t){var e="#";return t.forEach((function(t){t<16&&(e+=0),e+=t.toString(16)})),e},t.prototype.hsl2rgb=function(t,e,r){var n=r<.5?r*(1+e):r+e-r*e,o=2*r-n;return[(t/=360)+1/3,t,t-1/3].map((function(t){return t<0&&t++,t>1&&t--,t=t<1/6?o+6*(n-o)*t:t<.5?n:t<2/3?o+6*(n-o)*(2/3-t):o,Math.round(255*t)}))},t.prototype.hsl=function(t){var e,r,n=this.hash(t);if(this.hueRanges.length){var o=this.hueRanges[n%this.hueRanges.length];e=n/this.hueRanges.length%727*(o.max-o.min)/727+o.min}else e=n%359;return n=Math.round(n/360),r=this.S[n%this.S.length],n=Math.round(n/this.S.length),[e,r,this.L[n%this.L.length]]},t.prototype.rgb=function(t){var e=this.hsl(t);return this.hsl2rgb(e[0],e[1],e[2])},t.prototype.hex=function(t){var e=this.rgb(t);return this.rgb2hex(e)},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t},token:t,providedIn:"root"}),t=s([e.Injectable({providedIn:"root"})],t)}(),p=function(){function t(){var t=this;this.fileInput=document.createElement("input"),this.fileInput.type="file",this.fileInput.addEventListener("change",(function(e){new FileReader;t.loadValue(e.target.files)}))}return t.prototype.loadValue=function(t){var e=this;if(t&&t.length>0)for(var r=[],n=function(n){var o=t.item(n),a=new FileReader;a.readAsDataURL(o),a.onload=function(){r.push(Object.assign(o,{data:a.result})),r.length==t.length&&(e.callback(r.length>0?r:null),e.fileInput.value=null)}},o=0;o<t.length;o++)n(o)},t.prototype.open=function(t,e){this.fileInput.accept=e&&e.accept?e.accept:"",this.fileInput.multiple=e&&e.multiple,this.fileInput.click(),this.callback=t},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t},token:t,providedIn:"root"}),t=s([e.Injectable({providedIn:"root"})],t)}(),f=function(){function t(t){this.router=t}return t.prototype.appendTrackingCode=function(t){try{if(t){this.trackingId=t;var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id="+t,document.head.appendChild(e);var r=document.createElement("script");r.innerHTML="\n         window.dataLayer = window.dataLayer || [];\n         function gtag(){dataLayer.push(arguments);}\n         gtag('js', new Date());\n         gtag('config', '"+t+"');\n       ",document.head.appendChild(r),this.initSubscribers()}}catch(t){console.error("Error appending google analytics"),console.error(t)}},t.prototype.initSubscribers=function(){var t=this;this.router.events.subscribe((function(e){try{"function"==typeof gtag&&e instanceof o.NavigationEnd&&t.trackingId&&setTimeout((function(){gtag("config",t.trackingId,{page_title:document.title,page_path:e.urlAfterRedirects})}),100)}catch(t){console.error(t)}}))},t.prototype.trackEvent=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),"function"==typeof gtag&&gtag("event",t,{event_category:e,event_label:r,value:n})},t.prototype.trackException=function(t,e){"function"==typeof gtag&&gtag("event","exception",{description:t,fatal:e})},t.prototype.setUserId=function(t){"function"==typeof gtag&&gtag("set",{user_id:t})},t.ctorParameters=function(){return[{type:o.Router}]},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t(e["ɵɵinject"](o.Router))},token:t,providedIn:"root"}),t=s([e.Injectable({providedIn:"root"})],t)}(),g=function(){function t(t){this.injector=t}return t.prototype.handleError=function(t){var e=this.injector.get(f);if(t instanceof n.HttpErrorResponse){if(navigator.onLine){var o=t.error?JSON.stringify(t.error):t.message;e.trackEvent(t.url,"Http Error",t.status+" - "+o)}}else{var a=this.injector.get(r.LocationStrategy),i=(o=t.message?t.message:t.toString(),t.stack?t.stack:t.toString());a instanceof r.PathLocationStrategy&&a.path();e.trackEvent(o,"Javascript Error",i)}throw t},t.ctorParameters=function(){return[{type:e.Injector}]},t=s([e.Injectable()],t)}(),d=function(){function t(t){this.injector=t}return t.prototype.handleError=function(t){if(t instanceof n.HttpErrorResponse&&navigator.onLine){var e=t.error?JSON.stringify(t.error):t.message;window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"http_error","gtm.errorMessage":e,"gtm.errorUrl":t.url,error_status:t.status})}throw t},t.ctorParameters=function(){return[{type:e.Injector}]},t=s([e.Injectable()],t)}(),h=function(){function t(t){this.platformId=t}return t.prototype.appendTrackingCode=function(t){try{if(r.isPlatformBrowser(this.platformId)&&t){this.trackingId=t;var e=document.createElement("script");e.innerHTML="\n          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n          })(window,document,'script','dataLayer','"+t+"');\n        ",document.head.appendChild(e);var n=document.createElement("noscript"),o=document.createElement("iframe");o.width="0",o.height="0",o.style.display="none",o.style.visibility="hidden",o.src="https://www.googletagmanager.com/ns.html?id="+t,n.appendChild(o),document.body.prepend(n)}}catch(t){console.error("Error appending google tag manager"),console.error(t)}},t.prototype.addVariable=function(t){window.dataLayer=window.dataLayer||[],window.dataLayer.push(t)},t.ctorParameters=function(){return[{type:Object,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]}]},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t(e["ɵɵinject"](e.PLATFORM_ID))},token:t,providedIn:"root"}),t=s([e.Injectable({providedIn:"root"}),u(0,e.Inject(e.PLATFORM_ID))],t)}(),y=function(){function t(t,e){this.platformId=t,this.configuration=e}return t.prototype.getValue=function(t,e){var r;if(e&&"string"!=typeof e)"object"==typeof e&&(r=e[t]);else switch(e){case"local":case"localStorage":r=localStorage[t];break;case"memory":r=this.memoryStorage[t];break;default:r=sessionStorage[t]}return this.decrypt(r)},t.prototype.decrypt=function(t){null!=t&&""!==t&&this.configuration&&this.configuration.storage&&this.configuration.storage.encryptionSecret&&(t=a.AES.decrypt(t,this.configuration.storage.encryptionSecret).toString(a.enc.Utf8));return t},t.prototype.encrypt=function(t){return null!=t&&""!==t&&this.configuration&&this.configuration.storage&&this.configuration.storage.encryptionSecret?(t=a.AES.encrypt(t,this.configuration.storage.encryptionSecret)).toString():t},t.prototype.delete=function(t,e){if(r.isPlatformBrowser(this.platformId))if(e&&"string"!=typeof e)"object"==typeof e&&delete e[t];else switch(e){case"local":case"localStorage":delete localStorage[t];break;case"memory":delete this.memoryStorage[t];break;default:delete sessionStorage[t]}},t.prototype.get=function(t,e){var n;if(r.isPlatformBrowser(this.platformId))try{n=JSON.parse(this.getValue(t,e))}catch(r){n=this.getValue(t,e)}return n},t.prototype.set=function(t,e,n){if(r.isPlatformBrowser(this.platformId)){var o=this.encrypt(JSON.stringify(e));if(n&&"string"!=typeof n)n[t]=o;else switch(n){case"local":case"localStorage":localStorage[t]=o;break;case"memory":this.memoryStorage[t]=o;break;default:sessionStorage[t]=o}}},t.ctorParameters=function(){return[{type:Object,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:void 0,decorators:[{type:e.Inject,args:["FactorUtilsConfiguration"]}]}]},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t(e["ɵɵinject"](e.PLATFORM_ID),e["ɵɵinject"]("FactorUtilsConfiguration"))},token:t,providedIn:"root"}),t=s([e.Injectable({providedIn:"root"}),u(0,e.Inject(e.PLATFORM_ID)),u(1,e.Inject("FactorUtilsConfiguration"))],t)}(),m=function(){function t(){this.cacheMap=new Map}return t.prototype.get=function(t){var e=this.cacheMap.get(t.urlWithParams);return e?Date.now()-e.entryTime>36e5?null:e.response:null},t.prototype.put=function(t,e){var r={url:t.urlWithParams,response:e,entryTime:Date.now()};this.cacheMap.set(t.urlWithParams,r),this.deleteExpired()},t.prototype.invalidate=function(t){this.cacheMap.delete(t)},t.prototype.deleteExpired=function(){var t=this;this.cacheMap.forEach((function(e){Date.now()-e.entryTime>36e5&&t.cacheMap.delete(e.url)}))},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t},token:t,providedIn:"root"}),t=s([e.Injectable({providedIn:"root"})],t)}(),v=function(){function t(t,e){this.cacheService=t,this.configuration=e}return t.prototype.intercept=function(t,e){var r=this;if(!this.isRequestCachable(t))return e.handle(t);var o=this.cacheService.get(t);return null!==o?i.of(o):e.handle(t).pipe(c.tap((function(e){e instanceof n.HttpResponse&&r.cacheService.put(t,e)})))},t.prototype.isRequestCachable=function(t){return"GET"===t.method&&this.configuration.cache.urls.find((function(e){return t.url.indexOf(e)>-1}))},t.ctorParameters=function(){return[{type:m},{type:void 0,decorators:[{type:e.Inject,args:["FactorUtilsConfiguration"]}]}]},t=s([e.Injectable(),u(1,e.Inject("FactorUtilsConfiguration"))],t)}(),I=function(){function t(){}var r;return r=t,t.forRoot=function(t){return{ngModule:r,providers:[{provide:"FactorUtilsConfiguration",useValue:t}]}},t=r=s([e.NgModule({declarations:[],imports:[],exports:[]})],t)}();t.CacheInterceptor=v,t.CacheService=m,t.ColorService=l,t.FilesService=p,t.GoogleAnalyticsErrorHandler=g,t.GoogleAnalyticsService=f,t.GoogleTagManagerErrorHandler=d,t.GoogleTagManagerService=h,t.StorageService=y,t.UtilsModule=I,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=factor-utils.umd.min.js.map