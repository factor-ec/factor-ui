!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("crypto-js"),require("@angular/router"),require("@angular/common/http"),require("@angular/common"),require("rxjs"),require("@angular/core")):"function"==typeof define&&define.amd?define("factor-utils",["exports","crypto-js","@angular/router","@angular/common/http","@angular/common","rxjs","@angular/core"],t):t(e["factor-utils"]={},e.CryptoJS,e.ng.router,e.ng.common.http,e.ng.common,e.rxjs,e.ng.core)}(this,function(e,t,o,a,i,r,n){"use strict";var c=(s.prototype["delete"]=function(e,t){if(i.isPlatformBrowser(this.platformId))if(t&&"string"!=typeof t)"object"==typeof t&&delete t[e];else switch(t){case"local":case"localStorage":delete localStorage[e];break;case"memory":delete this.memoryStorage[e];break;default:delete sessionStorage[e]}},s.prototype.get=function(e,t){var r;if(i.isPlatformBrowser(this.platformId))try{r=JSON.parse(this.getValue(e,t))}catch(o){r=this.getValue(e,t)}return r},s.prototype.getValue=function(e,t){var r;if(t&&"string"!=typeof t)"object"==typeof t&&(r=t[e]);else switch(t){case"local":case"localStorage":r=localStorage[e];break;case"memory":r=this.memoryStorage[e];break;default:r=sessionStorage[e]}return this.decrypt(r)},s.prototype.decrypt=function(e){return null!==e&&e!==undefined&&""!==e&&this.configuration&&this.configuration.storage&&this.configuration.storage.encryptionSecret&&(e=t.AES.decrypt(e,this.configuration.storage.encryptionSecret).toString(t.enc.Utf8)),e},s.prototype.encrypt=function(e){return null!==e&&e!==undefined&&""!==e&&this.configuration&&this.configuration.storage&&this.configuration.storage.encryptionSecret?(e=t.AES.encrypt(e,this.configuration.storage.encryptionSecret)).toString():e},s.prototype.set=function(e,t,r){if(i.isPlatformBrowser(this.platformId)){var o=this.encrypt(JSON.stringify(t));if(r&&"string"!=typeof r)r[e]=o;else switch(r){case"local":case"localStorage":localStorage[e]=o;break;case"memory":this.memoryStorage[e]=o;break;default:sessionStorage[e]=o}}},s.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],s.ctorParameters=function(){return[{type:Object,decorators:[{type:n.Inject,args:[n.PLATFORM_ID]}]},{type:undefined,decorators:[{type:n.Inject,args:["FactorUtilsConfiguration"]}]}]},s.ngInjectableDef=n.defineInjectable({factory:function(){return new s(n.inject(n.PLATFORM_ID),n.inject("FactorUtilsConfiguration"))},token:s,providedIn:"root"}),s);function s(e,t){this.platformId=e,this.configuration=t}var l=(u.prototype.appendTrackingCode=function(e){try{if(e){this.trackingId=e;var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id="+e,document.head.appendChild(t);var r=document.createElement("script");r.innerHTML="\n         window.dataLayer = window.dataLayer || [];\n         function gtag(){dataLayer.push(arguments);}\n         gtag('js', new Date());\n         gtag('config', '"+e+"');\n       ",document.head.appendChild(r),this.initSubscribers()}}catch(o){console.error("Error appending google analytics"),console.error(o)}},u.prototype.initSubscribers=function(){var r=this;this.router.events.subscribe(function(e){try{"function"==typeof gtag&&e instanceof o.NavigationEnd&&r.trackingId&&setTimeout(function(){gtag("config",r.trackingId,{page_title:document.title,page_path:e.urlAfterRedirects})},100)}catch(t){console.error(t)}})},u.prototype.trackEvent=function(e,t,r,o){void 0===t&&(t=null),void 0===r&&(r=null),void 0===o&&(o=null),"function"==typeof gtag&&gtag("event",e,{event_category:t,event_label:r,value:o})},u.prototype.trackException=function(e,t){"function"==typeof gtag&&gtag("event","exception",{description:e,fatal:t})},u.prototype.setUserId=function(e){"function"==typeof gtag&&gtag("set",{user_id:e})},u.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],u.ctorParameters=function(){return[{type:o.Router}]},u.ngInjectableDef=n.defineInjectable({factory:function(){return new u(n.inject(o.Router))},token:u,providedIn:"root"}),u);function u(e){this.router=e}var g=(p.prototype.handleError=function(e){var t=this.injector.get(l);if(e instanceof a.HttpErrorResponse){if(navigator.onLine){var r=e.error?JSON.stringify(e.error):e.message;t.trackEvent(e.url,"Http Error",e.status+" - "+r)}}else{var o=this.injector.get(i.LocationStrategy),n=(r=e.message?e.message:e.toString(),e.stack?e.stack:e.toString());o instanceof i.PathLocationStrategy&&o.path(),t.trackEvent(r,"Javascript Error",n)}throw e},p.decorators=[{type:n.Injectable}],p.ctorParameters=function(){return[{type:n.Injector}]},p);function p(e){this.injector=e}var d=(f.prototype.handleError=function(e){if(e instanceof a.HttpErrorResponse&&navigator.onLine){var t=e.error?JSON.stringify(e.error):e.message;window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"http_error","gtm.errorMessage":t,"gtm.errorUrl":e.url,error_status:e.status})}throw e},f.decorators=[{type:n.Injectable}],f.ctorParameters=function(){return[{type:n.Injector}]},f);function f(e){this.injector=e}var y=(h.prototype.appendTrackingCode=function(e){try{if(i.isPlatformBrowser(this.platformId)&&e){this.trackingId=e;var t=document.createElement("script");t.innerHTML="\n          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n          })(window,document,'script','dataLayer','"+e+"');\n        ",document.head.appendChild(t);var r=document.createElement("noscript"),o=document.createElement("iframe");o.width="0",o.height="0",o.style.display="none",o.style.visibility="hidden",o.src="https://www.googletagmanager.com/ns.html?id="+e,r.appendChild(o),document.body.prepend(r)}}catch(n){console.error("Error appending google tag manager"),console.error(n)}},h.prototype.addVariable=function(e){window.dataLayer=window.dataLayer||[],window.dataLayer.push(e)},h.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],h.ctorParameters=function(){return[{type:Object,decorators:[{type:n.Inject,args:[n.PLATFORM_ID]}]}]},h.ngInjectableDef=n.defineInjectable({factory:function(){return new h(n.inject(n.PLATFORM_ID))},token:h,providedIn:"root"}),h);function h(e){this.platformId=e}var m=(v.prototype.loadValue=function(o){var n=this;if(o&&0<o.length)for(var a=[],e=function(e){var t=o.item(e),r=new FileReader;r.readAsDataURL(t),r.onload=function(){a.push({data:r.result,lastModifiedDate:t.lastModifiedDate,name:t.name,size:t.size}),a.length==o.length&&n.valueChangesSubject.next(0<a.length?a:null)}},t=0;t<o.length;t++)e(t)},v.prototype.open=function(){this.fileInput.click()},v);function v(e){var t=this;this.valueChangesSubject=new r.BehaviorSubject(null),this.valueChanges=this.valueChangesSubject.asObservable(),this.fileInput=document.createElement("input"),this.fileInput.style.display="none",this.fileInput.type="file",this.fileInput.accept=e&&e.accept?e.accept:"",this.fileInput.multiple=e&&e.multiple,this.fileInput.addEventListener("change",function(e){new FileReader;t.loadValue(e.target.files)}),document.body.appendChild(this.fileInput)}var w=(j.forRoot=function(e){return{ngModule:j,providers:[{provide:"FactorUtilsConfiguration",useValue:e}]}},j.decorators=[{type:n.NgModule,args:[{declarations:[],imports:[],exports:[]}]}],j);function j(){}e.StorageService=c,e.GoogleAnalyticsErrorHandler=g,e.GoogleAnalyticsService=l,e.GoogleTagManagerErrorHandler=d,e.GoogleTagManagerService=y,e.FilesList=m,e.UtilsModule=w,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=factor-utils.umd.min.js.map