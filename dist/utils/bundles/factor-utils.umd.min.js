!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/router"),require("@angular/common/http"),require("@angular/common"),require("crypto-js"),require("@angular/core")):"function"==typeof define&&define.amd?define("factor-utils",["exports","@angular/router","@angular/common/http","@angular/common","crypto-js","@angular/core"],e):e(t["factor-utils"]={},t.ng.router,t.ng.common.http,t.ng.common,t.CryptoJS,t.ng.core)}(this,function(t,o,a,i,e,r){"use strict";var n=(c.prototype.loadValue=function(o){var n=this;if(o&&0<o.length)for(var a=[],t=function(t){var e=o.item(t),r=new FileReader;r.readAsDataURL(e),r.onload=function(){a.push(Object.assign(e,{data:r.result})),a.length==o.length&&(n.callback(0<a.length?a:null),n.fileInput.value=null)}},e=0;e<o.length;e++)t(e)},c.prototype.open=function(t,e){this.fileInput.accept=e&&e.accept?e.accept:"",this.fileInput.multiple=e&&e.multiple,this.fileInput.click(),this.callback=t},c.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],c.ctorParameters=function(){return[]},c.ngInjectableDef=r.defineInjectable({factory:function(){return new c},token:c,providedIn:"root"}),c);function c(){var e=this;this.fileInput=document.createElement("input"),this.fileInput.type="file",this.fileInput.addEventListener("change",function(t){new FileReader;e.loadValue(t.target.files)})}var s=(l.prototype.appendTrackingCode=function(t){try{if(t){this.trackingId=t;var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id="+t,document.head.appendChild(e);var r=document.createElement("script");r.innerHTML="\n         window.dataLayer = window.dataLayer || [];\n         function gtag(){dataLayer.push(arguments);}\n         gtag('js', new Date());\n         gtag('config', '"+t+"');\n       ",document.head.appendChild(r),this.initSubscribers()}}catch(o){console.error("Error appending google analytics"),console.error(o)}},l.prototype.initSubscribers=function(){var r=this;this.router.events.subscribe(function(t){try{"function"==typeof gtag&&t instanceof o.NavigationEnd&&r.trackingId&&setTimeout(function(){gtag("config",r.trackingId,{page_title:document.title,page_path:t.urlAfterRedirects})},100)}catch(e){console.error(e)}})},l.prototype.trackEvent=function(t,e,r,o){void 0===e&&(e=null),void 0===r&&(r=null),void 0===o&&(o=null),"function"==typeof gtag&&gtag("event",t,{event_category:e,event_label:r,value:o})},l.prototype.trackException=function(t,e){"function"==typeof gtag&&gtag("event","exception",{description:t,fatal:e})},l.prototype.setUserId=function(t){"function"==typeof gtag&&gtag("set",{user_id:t})},l.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],l.ctorParameters=function(){return[{type:o.Router}]},l.ngInjectableDef=r.defineInjectable({factory:function(){return new l(r.inject(o.Router))},token:l,providedIn:"root"}),l);function l(t){this.router=t}var u=(g.prototype.handleError=function(t){var e=this.injector.get(s);if(t instanceof a.HttpErrorResponse){if(navigator.onLine){var r=t.error?JSON.stringify(t.error):t.message;e.trackEvent(t.url,"Http Error",t.status+" - "+r)}}else{var o=this.injector.get(i.LocationStrategy),n=(r=t.message?t.message:t.toString(),t.stack?t.stack:t.toString());o instanceof i.PathLocationStrategy&&o.path(),e.trackEvent(r,"Javascript Error",n)}throw t},g.decorators=[{type:r.Injectable}],g.ctorParameters=function(){return[{type:r.Injector}]},g);function g(t){this.injector=t}var p=(d.prototype.handleError=function(t){if(t instanceof a.HttpErrorResponse&&navigator.onLine){var e=t.error?JSON.stringify(t.error):t.message;window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"http_error","gtm.errorMessage":e,"gtm.errorUrl":t.url,error_status:t.status})}throw t},d.decorators=[{type:r.Injectable}],d.ctorParameters=function(){return[{type:r.Injector}]},d);function d(t){this.injector=t}var f=(y.prototype.appendTrackingCode=function(t){try{if(i.isPlatformBrowser(this.platformId)&&t){this.trackingId=t;var e=document.createElement("script");e.innerHTML="\n          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n          })(window,document,'script','dataLayer','"+t+"');\n        ",document.head.appendChild(e);var r=document.createElement("noscript"),o=document.createElement("iframe");o.width="0",o.height="0",o.style.display="none",o.style.visibility="hidden",o.src="https://www.googletagmanager.com/ns.html?id="+t,r.appendChild(o),document.body.prepend(r)}}catch(n){console.error("Error appending google tag manager"),console.error(n)}},y.prototype.addVariable=function(t){window.dataLayer=window.dataLayer||[],window.dataLayer.push(t)},y.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],y.ctorParameters=function(){return[{type:Object,decorators:[{type:r.Inject,args:[r.PLATFORM_ID]}]}]},y.ngInjectableDef=r.defineInjectable({factory:function(){return new y(r.inject(r.PLATFORM_ID))},token:y,providedIn:"root"}),y);function y(t){this.platformId=t}var m=(h.prototype["delete"]=function(t,e){if(i.isPlatformBrowser(this.platformId))if(e&&"string"!=typeof e)"object"==typeof e&&delete e[t];else switch(e){case"local":case"localStorage":delete localStorage[t];break;case"memory":delete this.memoryStorage[t];break;default:delete sessionStorage[t]}},h.prototype.get=function(t,e){var r;if(i.isPlatformBrowser(this.platformId))try{r=JSON.parse(this.getValue(t,e))}catch(o){r=this.getValue(t,e)}return r},h.prototype.getValue=function(t,e){var r;if(e&&"string"!=typeof e)"object"==typeof e&&(r=e[t]);else switch(e){case"local":case"localStorage":r=localStorage[t];break;case"memory":r=this.memoryStorage[t];break;default:r=sessionStorage[t]}return this.decrypt(r)},h.prototype.decrypt=function(t){return null!==t&&t!==undefined&&""!==t&&this.configuration&&this.configuration.storage&&this.configuration.storage.encryptionSecret&&(t=e.AES.decrypt(t,this.configuration.storage.encryptionSecret).toString(e.enc.Utf8)),t},h.prototype.encrypt=function(t){return null!==t&&t!==undefined&&""!==t&&this.configuration&&this.configuration.storage&&this.configuration.storage.encryptionSecret?(t=e.AES.encrypt(t,this.configuration.storage.encryptionSecret)).toString():t},h.prototype.set=function(t,e,r){if(i.isPlatformBrowser(this.platformId)){var o=this.encrypt(JSON.stringify(e));if(r&&"string"!=typeof r)r[t]=o;else switch(r){case"local":case"localStorage":localStorage[t]=o;break;case"memory":this.memoryStorage[t]=o;break;default:sessionStorage[t]=o}}},h.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],h.ctorParameters=function(){return[{type:Object,decorators:[{type:r.Inject,args:[r.PLATFORM_ID]}]},{type:undefined,decorators:[{type:r.Inject,args:["FactorUtilsConfiguration"]}]}]},h.ngInjectableDef=r.defineInjectable({factory:function(){return new h(r.inject(r.PLATFORM_ID),r.inject("FactorUtilsConfiguration"))},token:h,providedIn:"root"}),h);function h(t,e){this.platformId=t,this.configuration=e}var v=(w.forRoot=function(t){return{ngModule:w,providers:[{provide:"FactorUtilsConfiguration",useValue:t}]}},w.decorators=[{type:r.NgModule,args:[{declarations:[],imports:[],exports:[]}]}],w);function w(){}t.FilesService=n,t.GoogleAnalyticsErrorHandler=u,t.GoogleAnalyticsService=s,t.GoogleTagManagerErrorHandler=p,t.GoogleTagManagerService=f,t.StorageService=m,t.UtilsModule=v,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=factor-utils.umd.min.js.map